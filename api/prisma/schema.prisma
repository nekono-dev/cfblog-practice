generator client {
  provider        = "prisma-client-js"
  output          = "../src/generated/prisma"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Page {
  id             Int      @id @unique @default(autoincrement())
  pageId         String   @unique
  title          String
  text           String?
  imgId          String?
  date           DateTime
  isPublic       Boolean  @default(true)
  likes          Like[]
  tags           Tag[]    @relation("PageTags")
  visibleToUsers User[]   @relation("UserPageVisibility")
}

model Tag {
  id    Int    @id @unique @default(autoincrement())
  label String @unique
  pages Page[] @relation("PageTags")
}

model Like {
  id     Int  @id @unique @default(autoincrement())
  count  Int
  page   Page @relation(fields: [pageId], references: [id])
  pageId Int
  user   User @relation(fields: [userId], references: [id])
  userId Int
}

model User {
  id             Int       @id @unique @default(autoincrement())
  handle         String    @unique
  name           String
  hashedPassword String
  birthday       DateTime?
  writeAble      Boolean   @default(false)
  likes          Like[]
  visiblePages   Page[]    @relation("UserPageVisibility")
}
